<!DOCTYPE html>
<html>
  <head>
    <title>Chatbot</title>
  </head>
  <body>
    <div class="js-container"></div>

    

    <script src="https://unpkg.com/supersimpledev/react.js"></script>
    <script src="https://unpkg.com/supersimpledev/react-dom.js"></script>

    <script src="https://unpkg.com/supersimpledev/chatbot.js"></script>

    <script src="https://unpkg.com/supersimpledev/babel.js"></script>
    <script type="text/babel">//translates all the code below into normal javascript

    function ChatInput({chatMessages, setChatMessages }){
      const [inputText, setInputText] = React.useState('');

      function saveInputText(event){
        setInputText(event.target.value);
      }

      function sendMessage(){
        setChatMessages([
          //copy of chat messages array
            ...chatMessages,
            {
              message: inputText,
              sender: "user",
              id: crypto.randomUUID()
            }
         ]);

        const response = Chatbot.getResponse(inputText)
        console.log(response);

         setInputText('')
      }

      return(
        <>
          <input 
            placeholder="send message to Chatbot" 
            size="30"
            onChange={saveInputText}
            value={inputText}
          />
          <button
            onClick={sendMessage}
          >
          Send
          </button>
        </>
      );
    }

    function ChatMessage({message, sender}){
      // const message = props.message;
      // const sender = props.sender;

      // const{message, sender} = props;

      /* if (sender === 'robot'){
        return(
          <div>
            <img src="robot.png" width="50"/>
            {message}
        </div>
        );
      } */

      return(
        <div>
          {sender === 'robot' && (
            <img src="robot.png" width="50"/>
          )}
          {message}
          {sender === 'user' && (
            <img src="user.png" width="50"/>
          )}
        </div>
      );
    }

    function ChatMessages({chatMessages}){
        return(
          <>
            {chatMessages.map((chatMessage)=>{
                return(
                  <ChatMessage 
                    message = {chatMessage.message}
                    sender = {chatMessage.sender}
                    key = {chatMessage.id}
                  />
                );
              })}
          </>
        );
    }

    function App(){
      
      const [chatMessages, setChatMessages] = React.useState([{
          message: 'Hello Chatbot',
          sender: 'user',
          id: 'id1'
        },
        {
          message: 'Hello! How can i help you',
          sender: 'robot',
          id: 'id2'
        },
        {
          message: "Can you get me today's date?",
          sender: 'user',
          id: 'id3'
        },
        {
          message: 'Today is 30th July, 2022',
          sender: 'robot',
          id: 'id4'
        }]);
      // const [chatMessage, setChatMessages] = array;
      // const chatMessages = array[0]; //current data
      // const setChatMessages = array[1]; //function to change the data

      return(
        <>
          <ChatInput 
            chatMessages={chatMessages}
            setChatMessages={setChatMessages}
          />
          <ChatMessages 
            chatMessages={chatMessages} 
          />
        </>
      );
    }

      const container = document.querySelector('.js-container');
      ReactDOM.createRoot(container).render(<App />);
    </script>
  </body>
</html>